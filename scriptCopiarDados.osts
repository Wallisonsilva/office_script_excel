{"version":"0.2.0","body":"/**\n * Filtra os dados da tabela \"tabelaReddit\" no workbook, retornando apenas as linhas onde a coluna 'subreddit' é igual a \"analytics\".\n * @param {ExcelScript.Workbook} workbook - O workbook do Excel.\n * @returns {string} Uma representação JSON dos dados filtrados.\n */\nfunction main(workbook: ExcelScript.Workbook): string {\n\n  // Obtém a aba chamada 'reddit_database' no workbook\n  const abaReddit = workbook.getWorksheet('reddit_database')\n\n  // Define a visualização temporária\n  abaReddit.enterTemporaryNamedSheetView();\n\n  // Obtém a tabela chamada \"tabelaReddit\" no workbook\n  const tabelaReddit = abaReddit.getTable('tabelaReddit');\n\n  if (!tabelaReddit) {\n    throw new Error(\"A tabela 'tabelaReddit' não foi encontrada no workbook.\");\n  }\n\n  // Obtém a coluna \"subreddit\" e aplica o filtro para \"analytics\"\n  const colunaSubreddit = tabelaReddit.getColumnByName('subreddit');\n  colunaSubreddit.getFilter().applyValuesFilter(['analytics']);\n\n  // Obtém os dados filtrados\n  const dadosFiltrados = tabelaReddit.getRangeBetweenHeaderAndTotal().getVisibleView().getRange().getVisibleView().getValues();\n\n  // Limpa a visualização temporária\n  abaReddit.exitActiveNamedSheetView();\n\n  return JSON.stringify(dadosFiltrados);\n}","description":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}},\"signature\":{\"comment\":\"Filtra os dados da tabela \\\"tabelaReddit\\\" no workbook, retornando apenas as linhas onde a coluna 'subreddit' é igual a \\\"analytics\\\".\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"- O workbook do Excel.\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}